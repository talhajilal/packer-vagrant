1- Install Centos 7 enable epel repo. 2
2- Setup packer library in /usr/local/bin/packer
3- clone repo to git
5- copy iso image in directory
6- insert image md5sum sha 
7- yum install -y git wget unzip sshpass
8- install cpan 
yum install cpan # Make sure epel repo enable.
yum install gcc
yum install openssl-devel libxml2-dev e2fsprogs-dev
yum -y install libuuid-devel
VMware-Player
comment proxy lines 

9- Install ovf tools 
yum install qemu-img

# Note how to run packer in debug mode.
wiindows
$ set PACKER_LOG=10
$ set PACKER_LOG_PATH=c:\temp\packer.log
$ packer build -debug ubuntu_64.json

export for linux
$ export PACKER_LOG=10
$ export PACKER_LOG_PATH=c:\temp\packer.log
$ packer build -debug ubuntu_64.json





( Reading Links) : http://www.greenreedtech.com/building-vsphere-templates-from-scratch-using-packer-and-the-vsphere-api/


Disable " Esxi host firewall " 
# esxcli network firewall set --enabled false
" Kickstart in consistent network"
https://www.ispcolohost.com/2015/07/11/kickstarting-with-redhats-inconsistent-network-device-naming/



++++++++++++++++ 


Esx host setting  for packer direct VM building , 
Enable SSH
Inside the web UI, navigate to “Manage”, then the “Services” tab. Find the entry called: “TSM-SSH”, and enable it.

You may wish to enable it to start up with the host by default. You can do this inside the “Actions” dropdown (it’s nested inside “Policy”).

Enable “Guest IP Hack”
Run the following command on the ESXi host:

esxcli system settings advanced set -o /Net/GuestIPHack -i 1
This allows Packer to infer the guest IP from ESXi, without the VM needing to report it itself.

Open VNC Ports on the Firewall
Packer connects to the VM using VNC, so we’ll open a range of ports to allow it to connect to it.

First, ensure we can edit the firewall configuration:

chmod 644 /etc/vmware/firewall/service.xml
chmod +t /etc/vmware/firewall/service.xml
Then append the range we want to open to the end of the file:

<service id="1000">
  <id>packer-vnc</id>
  <rule id="0000">
    <direction>inbound</direction>
    <protocol>tcp</protocol>
    <porttype>dst</porttype>
    <port>
      <begin>5900</begin>
      <end>6000</end>
    </port>
  </rule>
  <enabled>true</enabled>
  <required>true</required>
</service>
Finally, restore the permissions and reload the firewall:

chmod 444 /etc/vmware/firewall/service.xml
esxcli network firewall refresh



++++++++++++++++++++++++++++++++++++++++++++++
